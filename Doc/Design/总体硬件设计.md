## 核心问题的解决思路

![基本原理](<assets/屏幕截图 2024-09-25 190410.png>)

通过一段时间的实践（折腾），研究了很多参考设计，体会到一个可调线性电源，面临的核心设计问题是：
- 需要高压运放对调整三极管输出足够高的，接近输出电压的高压，从而选型困难或者设计复杂或者贵（> 44V的很少了，同时很难做到即要高压同时又要高精密）
- 高端电流采样，反馈环路引入电流放大很容易不稳定（主要是采样电阻热噪声被放大，如果是高端还需要加上共模噪声，而高端电流放大一般对共模的抑制都不好）
- 调整三极管耗散功率在输入输出电压差很高时，不可接受（烧毁）

问题1、2解决思路如上图，其中可变电压源模拟了电压反馈环和电流反馈环，由于反馈控制整个“架在”高端，所以避免了电流反馈需要做高端采样，而且完全  
不需要任何高压运放和高压仪表放大器之类的器件，用低端器件就可以搭（反馈输出参考地是输出电压高端，所以只需要正负几V，甚至轨到轨正负5V的运放都能用）    
，缺点是电压反馈就变得更困难一些，因为对运放来讲要求输入电压接近地并且大于地，而对输出电压直接采样的话，无论如何都做不到（采样结果一定小于输出电压，也就是地）。  
当然也可以加一个反向放大器，让低于“地”的采样变为大于地的输出，但是在反馈环路中加放大器，是个需要很小心的事情，一不小心就震荡了。

相当于把输出电压加一个2.5V的参考电压偏移，然后再采样，巧妙的构造一个负反馈环：  
深度负反馈时候，根据虚短，可以得知(x+2.5)b=x+c，对，你没看错，采样反馈加在运放的正输入而不是负输入

![基本原理](<assets/屏幕截图 2024-09-25 191608.png>)

问题3的解决思路，是根据输出电压自动分段选择输入电压。

## 总体硬件设计

![基本原理](<assets/屏幕截图 2024-09-25 193709.png>)

核心问题不是问题之后，一切都是常规操作了。

如上图，很有苏联的傻大黑粗的味道，相当于是直接复制四份，然后加一个总控，每一个channel之间完全直流隔离，从而这四个channel可以串联用、并联用  
所以总体可以达到600W的功率，以及拼出最高120V+5A或者30V+20A的输出。

做4路还有一个好处是，可以同时提供多种不同的电压输出，极大方便了我们调试各种板子（例如同时提供3.3\5V\正负12V）这样的。

数控意味着可以在panel处通过电脑连USB控制4路电源，甚至使用程序扩展（例如写一段锂电池充电程序，先恒流再恒压等等）

## 选型

为啥XMeter用8051（STC的），总控用STM32，就是因为这两个片子我屯多了。。。。
